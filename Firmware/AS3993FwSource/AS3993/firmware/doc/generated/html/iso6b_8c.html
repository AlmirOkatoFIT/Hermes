<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>as3993 Firmware: iso6b.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">as3993 Firmware
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_3b1dcce1203a4246271d0209b54aa6ca.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">iso6b.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="global_8h_source.html">global.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="timer_8h_source.html">timer.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="bitbang_8h_source.html">bitbang.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="as3993_8h_source.html">as3993.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="iso6b_8h_source.html">iso6b.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="crc16_8h_source.html">crc16.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="logger_8h_source.html">logger.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="platform_8h_source.html">platform.h</a>&quot;</code><br/>
</div>
<p><a href="iso6b_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a8d8a33233d8c4c9c7b3998aadb427360"><td class="memItemLeft" align="right" valign="top">typedef void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="iso6b_8c.html#a8d8a33233d8c4c9c7b3998aadb427360">iso6bCmd</a> )(void)</td></tr>
<tr class="separator:a8d8a33233d8c4c9c7b3998aadb427360"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a4f9d021ffd27163e6154ffcc9f69b234"><td class="memItemLeft" align="right" valign="top">static s8&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="iso6b_8c.html#a4f9d021ffd27163e6154ffcc9f69b234">iso6bPreparePreambleDelimiter</a> (<a class="el" href="structt__bb_data.html">t_bbData</a> *preData)</td></tr>
<tr class="separator:a4f9d021ffd27163e6154ffcc9f69b234"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28d2b90fa4471ee952fd5834a214d800"><td class="memItemLeft" align="right" valign="top">static s8&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="iso6b_8c.html#a28d2b90fa4471ee952fd5834a214d800">iso6bPrepareByte</a> (<a class="el" href="structt__bb_data.html">t_bbData</a> *manchdata, u8 byteData)</td></tr>
<tr class="separator:a28d2b90fa4471ee952fd5834a214d800"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd6b9429c7e256607fb6c1fc1c676362"><td class="memItemLeft" align="right" valign="top">static s8&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="iso6b_8c.html#afd6b9429c7e256607fb6c1fc1c676362">iso6bPrepareCRC</a> (<a class="el" href="structt__bb_data.html">t_bbData</a> *crcData, s16 crc)</td></tr>
<tr class="separator:afd6b9429c7e256607fb6c1fc1c676362"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:affe295bb54e610a67f30321b6c9697b6"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="iso6b_8c.html#affe295bb54e610a67f30321b6c9697b6">iso6bResync</a> ()</td></tr>
<tr class="separator:affe295bb54e610a67f30321b6c9697b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4217256e0348ea2c63e6c69fd5d513c4"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="iso6b_8c.html#a4217256e0348ea2c63e6c69fd5d513c4">iso6bSendCmd</a> (u8 cmd)</td></tr>
<tr class="separator:a4217256e0348ea2c63e6c69fd5d513c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34846eb51251ad90efe188a3b98cfdce"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="iso6b_8c.html#a34846eb51251ad90efe188a3b98cfdce">iso6bSendResend</a> ()</td></tr>
<tr class="separator:a34846eb51251ad90efe188a3b98cfdce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37f0608f100047b4a87c084f36cf1ad5"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="iso6b_8c.html#a37f0608f100047b4a87c084f36cf1ad5">iso6bSendInitialize</a> ()</td></tr>
<tr class="separator:a37f0608f100047b4a87c084f36cf1ad5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac420817c18e5890fa30f755cdba5f8cc"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="iso6b_8c.html#ac420817c18e5890fa30f755cdba5f8cc">iso6bSendSuccess</a> ()</td></tr>
<tr class="separator:ac420817c18e5890fa30f755cdba5f8cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e28bfb47d65d4a16d83bfc03286f230"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="iso6b_8c.html#a3e28bfb47d65d4a16d83bfc03286f230">iso6bSendFail</a> ()</td></tr>
<tr class="separator:a3e28bfb47d65d4a16d83bfc03286f230"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5470f6ed93171ac5b45102ecb6f18466"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="iso6b_8c.html#a5470f6ed93171ac5b45102ecb6f18466">iso6bSendSelect</a> (u8 mask, u8 *filter, u8 startaddress)</td></tr>
<tr class="separator:a5470f6ed93171ac5b45102ecb6f18466"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a91f1b8d8e473982ae719a5c9ceaea75f"><td class="memItemLeft" align="right" valign="top">s8&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="iso6b_8c.html#a91f1b8d8e473982ae719a5c9ceaea75f">iso6bInitialize</a> ()</td></tr>
<tr class="separator:a91f1b8d8e473982ae719a5c9ceaea75f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0bbfb69c27973923b08e9d3bf2cfda22"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="iso6b_8c.html#a0bbfb69c27973923b08e9d3bf2cfda22">iso6bOpen</a> ()</td></tr>
<tr class="separator:a0bbfb69c27973923b08e9d3bf2cfda22"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97fb5bbf8b519a4676dd06507df15f61"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="iso6b_8c.html#a97fb5bbf8b519a4676dd06507df15f61">iso6bClose</a> ()</td></tr>
<tr class="separator:a97fb5bbf8b519a4676dd06507df15f61"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63b44f6afbe63906a84925f9a83dbaca"><td class="memItemLeft" align="right" valign="top">s8&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="iso6b_8c.html#a63b44f6afbe63906a84925f9a83dbaca">iso6bInventoryRound</a> (<a class="el" href="as3993__public_8h.html#a24e956eab72b3e331706283669924255">Tag</a> *tags, u8 maxtags, u8 mask, u8 *filter, u8 startaddress)</td></tr>
<tr class="separator:a63b44f6afbe63906a84925f9a83dbaca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f7b7d3c72dcbb382cf10f8af817bc08"><td class="memItemLeft" align="right" valign="top">s8&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="iso6b_8c.html#a1f7b7d3c72dcbb382cf10f8af817bc08">iso6bRead</a> (u8 *uid, u8 addr, u8 *buffer)</td></tr>
<tr class="separator:a1f7b7d3c72dcbb382cf10f8af817bc08"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a49257191783bde3da88bfa33f4fd1fd4"><td class="memItemLeft" align="right" valign="top">s8&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="iso6b_8c.html#a49257191783bde3da88bfa33f4fd1fd4">iso6bWrite</a> (u8 *uid, u8 addr, u8 data, u8 *buffer)</td></tr>
<tr class="separator:a49257191783bde3da88bfa33f4fd1fd4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ac392bf78f6fda7fcd1ee62e5311568ff"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="structt__bb_data.html">t_bbData</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="iso6b_8c.html#ac392bf78f6fda7fcd1ee62e5311568ff">cmdData</a> [50]</td></tr>
<tr class="separator:ac392bf78f6fda7fcd1ee62e5311568ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Implementation of ISO18000-6b protocol. </p>
<dl class="section author"><dt>Author</dt><dd>Rene Eggerstorfer (based on the work of C. Eisendle and T. Luecker (Substitute), project AS399x)</dd></dl>
<p>Implementation of ISO18000-6b protocol. </p>

<p>Definition in file <a class="el" href="iso6b_8c_source.html">iso6b.c</a>.</p>
</div><h2 class="groupheader">Typedef Documentation</h2>
<a class="anchor" id="a8d8a33233d8c4c9c7b3998aadb427360"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef void(* iso6bCmd)(void)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>function pointer indicating the function to be used in the next collision arbitration iteration </p>

<p>Definition at line <a class="el" href="iso6b_8c_source.html#l00064">64</a> of file <a class="el" href="iso6b_8c_source.html">iso6b.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a97fb5bbf8b519a4676dd06507df15f61"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void iso6bClose </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Close a session. </p>
<p>Close the session for iso6b protocol. </p>

<p>Definition at line <a class="el" href="iso6b_8c_source.html#l00118">118</a> of file <a class="el" href="iso6b_8c_source.html">iso6b.c</a>.</p>

</div>
</div>
<a class="anchor" id="a91f1b8d8e473982ae719a5c9ceaea75f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">s8 iso6bInitialize </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes the iso6b module. </p>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="iso6b_8h.html#a16259babdc84bc47d6b778fa718ea44d">ISO6B_ERR_NONE</a> : No error </dd></dl>

<p>Definition at line <a class="el" href="iso6b_8c_source.html#l00088">88</a> of file <a class="el" href="iso6b_8c_source.html">iso6b.c</a>.</p>

</div>
</div>
<a class="anchor" id="a63b44f6afbe63906a84925f9a83dbaca"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">s8 iso6bInventoryRound </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="as3993__public_8h.html#a24e956eab72b3e331706283669924255">Tag</a> *&#160;</td>
          <td class="paramname"><em>tags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u8&#160;</td>
          <td class="paramname"><em>maxtags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u8&#160;</td>
          <td class="paramname"><em>mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u8 *&#160;</td>
          <td class="paramname"><em>filter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u8&#160;</td>
          <td class="paramname"><em>startaddress</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function performs an iso6b inventory round and stores up to <em>maxtags</em> tags into the variable <em>tags</em>. It performs a select function which compares up to eight consecutive bytes within the tags to a given buffer. If the tag's memory content which starts at address <em>startaddress</em> matches the buffer given by <em>filter</em> the tag backscatters his UID. The bitmask <em>mask</em> is used to indicate which bytes of the buffer shall be compared with the tag's memory content. If <em>mask</em> is zero all tags are selected.</p>
<dl class="section note"><dt>Note</dt><dd>The function <a class="el" href="iso6b_8c.html#a0bbfb69c27973923b08e9d3bf2cfda22" title="Open a session. ">iso6bOpen()</a> has to be called first.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">tags</td><td>: an array of Tag structs which will be filled by this function </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">maxtags</td><td>: the size of the array </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mask</td><td>: mask identifying which bytes have to be compared </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">filter</td><td>: 8 byte long compare buffer </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">startaddress</td><td>: address of the first register to compare within the tag</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the number of tags found. </dd></dl>

<p>Definition at line <a class="el" href="iso6b_8c_source.html#l00122">122</a> of file <a class="el" href="iso6b_8c_source.html">iso6b.c</a>.</p>

</div>
</div>
<a class="anchor" id="a0bbfb69c27973923b08e9d3bf2cfda22"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void iso6bOpen </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Open a session. </p>
<p>Open a session for iso6b protocol.</p>
<p>Set iso6b specific parameters. </p>

<p>Definition at line <a class="el" href="iso6b_8c_source.html#l00099">99</a> of file <a class="el" href="iso6b_8c_source.html">iso6b.c</a>.</p>

</div>
</div>
<a class="anchor" id="a28d2b90fa4471ee952fd5834a214d800"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static s8 iso6bPrepareByte </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structt__bb_data.html">t_bbData</a> *&#160;</td>
          <td class="paramname"><em>manchdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u8&#160;</td>
          <td class="paramname"><em>byteData</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Convert a byte to manchester coded data. </p>
<p>The data within an ISO18000-6B packet is manchester encoded. E.g. a 0 is encoded as 01 and a 1 is encoded as 10.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">manchdata</td><td>: Buffer where the manchster coded data is stored. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">byteData</td><td>: data to write</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>: Actual size of the buffer used by the function </dd></dl>

<p>Definition at line <a class="el" href="iso6b_8c_source.html#l00439">439</a> of file <a class="el" href="iso6b_8c_source.html">iso6b.c</a>.</p>

</div>
</div>
<a class="anchor" id="afd6b9429c7e256607fb6c1fc1c676362"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static s8 iso6bPrepareCRC </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structt__bb_data.html">t_bbData</a> *&#160;</td>
          <td class="paramname"><em>crcData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">s16&#160;</td>
          <td class="paramname"><em>crc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Convert a the CRC checksum to manchester coded data. </p>
<p>The data within an ISO18000-6B packet is manchester encoded. E.g. a 0 is encoded as 01 and a 1 is encoded as 10. This function is used to convert the already calculated CRC-16 sum to manchester encoded data. The checksum is decribed in section 6.5.7.3. in ISO18000-6 doc</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">crcData</td><td>: A buffer where the encoded CRC will be written. Buffer must be allocated and has to have a size of 4 (at least) </td></tr>
    <tr><td class="paramname">crc</td><td>: CRC sum to send</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>: Actual size of the buffer used by the function </dd></dl>

<p>Definition at line <a class="el" href="iso6b_8c_source.html#l00482">482</a> of file <a class="el" href="iso6b_8c_source.html">iso6b.c</a>.</p>

</div>
</div>
<a class="anchor" id="a4f9d021ffd27163e6154ffcc9f69b234"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static s8 iso6bPreparePreambleDelimiter </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structt__bb_data.html">t_bbData</a> *&#160;</td>
          <td class="paramname"><em>preData</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Write the preamble and delimiter into the output packet. </p>
<p>This function writes the preamble and delimiter into the output packet. According to the ISO18000-6B protocol, a packet from the interrogator must start with a preamble and a delimiter. See section 8.1.4.3. and 8.1.4.4.2. of the ISO18000-6 document. The data is written to an output buffer which is then sent to the AS3991 via the bitbang module.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">preData</td><td>: A buffer where the preamble and delimiter will be written. Buffer must be allocated and has to have a size of 4 (at least)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>: Actual size of the buffer used by the function </dd></dl>

<p>Definition at line <a class="el" href="iso6b_8c_source.html#l00383">383</a> of file <a class="el" href="iso6b_8c_source.html">iso6b.c</a>.</p>

</div>
</div>
<a class="anchor" id="a1f7b7d3c72dcbb382cf10f8af817bc08"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">s8 iso6bRead </td>
          <td>(</td>
          <td class="paramtype">u8 *&#160;</td>
          <td class="paramname"><em>uid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u8&#160;</td>
          <td class="paramname"><em>startaddr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u8 *&#160;</td>
          <td class="paramname"><em>buffer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Issue READ command according to ISO18000-6 and stores the result in a buffer. </p>
<p>This function sends the READ command via the AS3993 to the tag with a given id. The data is read from start address <em>startaddr</em> until 8 bytes have been read. The answer is then written to the memory location pointed by <em>buffer</em>.</p>
<dl class="section note"><dt>Note</dt><dd>The function <a class="el" href="iso6b_8c.html#a0bbfb69c27973923b08e9d3bf2cfda22" title="Open a session. ">iso6bOpen()</a> has to be called first.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">uid</td><td>: 8 byte long uid of the tag </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">startaddr</td><td>: start address within the tag </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">buffer</td><td>: pointer to a memory location where the result shall be stored</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="iso6b_8h.html#a3cb707aecbc95da3175b7cd728911899">ISO6B_ERR_REG_FIFO</a> : Error reading the FIFO </dd>
<dd>
<a class="el" href="iso6b_8h.html#aca50f8b8482a5bda587d4e8d60a77574">ISO6B_ERR_NOTAG</a> : No response from tag </dd>
<dd>
<a class="el" href="iso6b_8h.html#a0dcea8a6bd403919a076c16b61090bb5">ISO6B_ERR_IRQ</a> : Irq Error </dd>
<dd>
<a class="el" href="iso6b_8h.html#a16259babdc84bc47d6b778fa718ea44d">ISO6B_ERR_NONE</a> : No error </dd></dl>

<p>Definition at line <a class="el" href="iso6b_8c_source.html#l00234">234</a> of file <a class="el" href="iso6b_8c_source.html">iso6b.c</a>.</p>

</div>
</div>
<a class="anchor" id="affe295bb54e610a67f30321b6c9697b6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void iso6bResync </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Send out a resync to the tags via the AS3993. </p>
<p>This function is used to send out a resync signal to the tags. This is needed to initialize the internal data recovery circuit of the tag which calibrates the tag. (Especially after read and write commands) </p>

<p>Definition at line <a class="el" href="iso6b_8c_source.html#l00409">409</a> of file <a class="el" href="iso6b_8c_source.html">iso6b.c</a>.</p>

</div>
</div>
<a class="anchor" id="a4217256e0348ea2c63e6c69fd5d513c4"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void iso6bSendCmd </td>
          <td>(</td>
          <td class="paramtype">u8&#160;</td>
          <td class="paramname"><em>cmd</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Send a command in direct mode according to ISO18000-6. </p>
<p>This function sends the command via the AS3993 to the tags. It only supports simple commands, i.e. commands where no additional information or data payload is needed. Note that the AS3993 needs to be in direct mode when using this function.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">cmd</td><td>: Command code to send </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="iso6b_8c_source.html#l00505">505</a> of file <a class="el" href="iso6b_8c_source.html">iso6b.c</a>.</p>

</div>
</div>
<a class="anchor" id="a3e28bfb47d65d4a16d83bfc03286f230"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void iso6bSendFail </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Issue FAIL command according to ISO18000-6. </p>
<p>The FAIL command is used during collision arbitration. FAIL is issued when there was a CRC error, i.e. more then one tag have replied. Tags having a count of 0 receiving the FAIL command call a random function (rand(0, 1)). If the function returns 0 they leave their internal count and resend the UID. If it returns 1 then they increment their counter, i.e. count is 1 then. All tags having a count greater than 0 increment their counter when they receive the FAIL command, i.e. they move fruther away from sending their UID. </p>

<p>Definition at line <a class="el" href="iso6b_8c_source.html#l00582">582</a> of file <a class="el" href="iso6b_8c_source.html">iso6b.c</a>.</p>

</div>
</div>
<a class="anchor" id="a37f0608f100047b4a87c084f36cf1ad5"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void iso6bSendInitialize </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Issue INITIALIZE command according to ISO18000-6. </p>
<p>The initialize command sets all tags into state READY. </p>

<p>Definition at line <a class="el" href="iso6b_8c_source.html#l00546">546</a> of file <a class="el" href="iso6b_8c_source.html">iso6b.c</a>.</p>

</div>
</div>
<a class="anchor" id="a34846eb51251ad90efe188a3b98cfdce"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void iso6bSendResend </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Issue RESEND command according to ISO18000-6. </p>
<p>The resend command is used during collision abitration. RESEND is issued when tags with count = 0 shall resend their UID while other tags shall keep their current count value. </p>

<p>Definition at line <a class="el" href="iso6b_8c_source.html#l00533">533</a> of file <a class="el" href="iso6b_8c_source.html">iso6b.c</a>.</p>

</div>
</div>
<a class="anchor" id="a5470f6ed93171ac5b45102ecb6f18466"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void iso6bSendSelect </td>
          <td>(</td>
          <td class="paramtype">u8&#160;</td>
          <td class="paramname"><em>mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u8 *&#160;</td>
          <td class="paramname"><em>filter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u8&#160;</td>
          <td class="paramname"><em>startaddress</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Issue the GROUP_SELECT command according to ISO18000-6. </p>
<p>The GROUP_SELECT command starts the collision arbitration. All tags receiving this command change their state from READY to ID, i.e. they set their internal counter to 0 and send their UID. </p>

<p>Definition at line <a class="el" href="iso6b_8c_source.html#l00597">597</a> of file <a class="el" href="iso6b_8c_source.html">iso6b.c</a>.</p>

</div>
</div>
<a class="anchor" id="ac420817c18e5890fa30f755cdba5f8cc"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void iso6bSendSuccess </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Issue SUCCESS command according to ISO18000-6. </p>
<p>The SUCCESS command is used during collision arbitration. SUCCESS is issued when NO reply has been received, i.e. all tags in the field have count &gt; 0. As soon as the tags receive the SUCCESS command, they decrement their counter. If count is 0 the tag transmits its uid. </p>

<p>Definition at line <a class="el" href="iso6b_8c_source.html#l00562">562</a> of file <a class="el" href="iso6b_8c_source.html">iso6b.c</a>.</p>

</div>
</div>
<a class="anchor" id="a49257191783bde3da88bfa33f4fd1fd4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">s8 iso6bWrite </td>
          <td>(</td>
          <td class="paramtype">u8 *&#160;</td>
          <td class="paramname"><em>uid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u8&#160;</td>
          <td class="paramname"><em>addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u8&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u8 *&#160;</td>
          <td class="paramname"><em>buffer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Issue WRITE command according to ISO18000-6 to write a specified number of bytes to a memory location within a tag. </p>
<p>This function sends the WRITE command via the AS3993 to the tag with a given <em>uid</em>. This command stores the <em>data</em> to the memory location at the <em>addr</em> on the tag.</p>
<dl class="section note"><dt>Note</dt><dd>WARNING: THIS FUNCTION WAS NEVER TESTED !!! </dd>
<dd>
The function <a class="el" href="iso6b_8c.html#a0bbfb69c27973923b08e9d3bf2cfda22" title="Open a session. ">iso6bOpen()</a> has to be called first.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">uid</td><td>: 8 byte long uid of the tag </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">addr</td><td>: address of the register to write </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td>: data to write </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">buffer</td><td>: pointer to a memory location where the result acknowledge or error shall be stored</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="iso6b_8h.html#a3cb707aecbc95da3175b7cd728911899">ISO6B_ERR_REG_FIFO</a> : Error reading the FIFO </dd>
<dd>
<a class="el" href="iso6b_8h.html#aca50f8b8482a5bda587d4e8d60a77574">ISO6B_ERR_NOTAG</a> : No response from tag </dd>
<dd>
<a class="el" href="iso6b_8h.html#a0dcea8a6bd403919a076c16b61090bb5">ISO6B_ERR_IRQ</a> : Irq Error </dd>
<dd>
<a class="el" href="iso6b_8h.html#a16259babdc84bc47d6b778fa718ea44d">ISO6B_ERR_NONE</a> : No error </dd></dl>

<p>Definition at line <a class="el" href="iso6b_8c_source.html#l00296">296</a> of file <a class="el" href="iso6b_8c_source.html">iso6b.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="ac392bf78f6fda7fcd1ee62e5311568ff"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structt__bb_data.html">t_bbData</a> cmdData[50]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>buffer used for the bitbang module </p>

<p>Definition at line <a class="el" href="iso6b_8c_source.html#l00053">53</a> of file <a class="el" href="iso6b_8c_source.html">iso6b.c</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Apr 7 2015 14:12:43 for as3993 Firmware by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
